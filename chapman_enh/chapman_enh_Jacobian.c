/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* The ODE Jacobian of Chemical Model File                          */
/*                                                                  */
/* Generated by KPP-2.2.3 symbolic chemistry Kinetics PreProcessor  */
/*       (http://www.cs.vt.edu/~asandu/Software/KPP)                */
/* KPP is distributed under GPL, the general public licence         */
/*       (http://www.gnu.org/copyleft/gpl.html)                     */
/* (C) 1995-1997, V. Damian & A. Sandu, CGRER, Univ. Iowa           */
/* (C) 1997-2005, A. Sandu, Michigan Tech, Virginia Tech            */
/*     With important contributions from:                           */
/*        M. Damian, Villanova University, USA                      */
/*        R. Sander, Max-Planck Institute for Chemistry, Mainz, Germany */
/*                                                                  */
/* File                 : chapman_enh_Jacobian.c                    */
/* Time                 : Sun Mar 20 10:54:49 2022                  */
/* Working directory    : /home/kyriacos/CyprusInstitute/kpp/chapman_enh */
/* Equation file        : chapman_enh.kpp                           */
/* Output root filename : chapman_enh                               */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>
#include <sys/time.h>
#include <float.h>
#include <xmmintrin.h>
#include "chapman_enh_Parameters.h"
#include "chapman_enh_Global.h"
#include "chapman_enh_Sparse.h"


/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* Jac_SP - the Jacobian of Variables in sparse matrix representation */
/*   Arguments :                                                    */
/*      V         - Concentrations of variable species (local)      */
/*      F         - Concentrations of fixed species (local)         */
/*      RCT       - Rate constants (local)                          */
/*      JVS       - sparse Jacobian of variables                    */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

void Jac_SP( 
  float V[],                             /* Concentrations of variable species (local) */
  float F[],                             /* Concentrations of fixed species (local) */
  float RCT[],                           /* Rate constants (local) */
  float JVS[]                            /* sparse Jacobian of variables */
)
{

/* Local variables                                                  */
float B[11];                             /* Temporary array */

/* B(1) = dA(1)/dV(0)                                               */
  B[1] = RCT[1]*F[0];
/* B(3) = dA(2)/dV(1)                                               */
  B[3] = RCT[2];
/* B(4) = dA(3)/dV(0)                                               */
  B[4] = RCT[3]*V[1];
/* B(5) = dA(3)/dV(1)                                               */
  B[5] = RCT[3]*V[0];
/* B(6) = dA(4)/dV(1)                                               */
  B[6] = RCT[4]*V[2];
/* B(7) = dA(4)/dV(2)                                               */
  B[7] = RCT[4]*V[1];
/* B(8) = dA(5)/dV(0)                                               */
  B[8] = RCT[5]*V[3];
/* B(9) = dA(5)/dV(3)                                               */
  B[9] = RCT[5]*V[0];
/* B(10) = dA(6)/dV(3)                                              */
  B[10] = RCT[6];

/* Construct the Jacobian terms from B's                            */
/* JVS(0) = Jac_FULL(0,0)                                           */
  JVS[0] = -B[1]-B[4]-B[8];
/* JVS(1) = Jac_FULL(0,1)                                           */
  JVS[1] = B[3]-B[5];
/* JVS(2) = Jac_FULL(0,3)                                           */
  JVS[2] = -B[9]+B[10];
/* JVS(3) = Jac_FULL(1,0)                                           */
  JVS[3] = B[1]-B[4];
/* JVS(4) = Jac_FULL(1,1)                                           */
  JVS[4] = -B[3]-B[5]-B[6];
/* JVS(5) = Jac_FULL(1,2)                                           */
  JVS[5] = -B[7];
/* JVS(6) = Jac_FULL(1,3)                                           */
  JVS[6] = 0;
/* JVS(7) = Jac_FULL(2,0)                                           */
  JVS[7] = B[8];
/* JVS(8) = Jac_FULL(2,1)                                           */
  JVS[8] = -B[6];
/* JVS(9) = Jac_FULL(2,2)                                           */
  JVS[9] = -B[7];
/* JVS(10) = Jac_FULL(2,3)                                          */
  JVS[10] = B[9]+B[10];
/* JVS(11) = Jac_FULL(3,0)                                          */
  JVS[11] = -B[8];
/* JVS(12) = Jac_FULL(3,1)                                          */
  JVS[12] = B[6];
/* JVS(13) = Jac_FULL(3,2)                                          */
  JVS[13] = B[7];
/* JVS(14) = Jac_FULL(3,3)                                          */
  JVS[14] = -B[9]-B[10];
}

/* End of Jac_SP function                                           */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */


/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* Jac_SP_Vec - function for sparse multiplication: sparse Jacobian times vector */
/*   Arguments :                                                    */
/*      JVS       - sparse Jacobian of variables                    */
/*      UV        - User vector for variables                       */
/*      JUV       - Jacobian times user vector                      */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

void Jac_SP_Vec( 
  float JVS[],                           /* sparse Jacobian of variables */
  float UV[],                            /* User vector for variables */
  float JUV[]                            /* Jacobian times user vector */
)
{
  JUV[0] = JVS[0]*UV[0]+JVS[1]*UV[1]+JVS[2]*UV[3];
  JUV[1] = JVS[3]*UV[0]+JVS[4]*UV[1]+JVS[5]*UV[2];
  JUV[2] = JVS[7]*UV[0]+JVS[8]*UV[1]+JVS[9]*UV[2]+JVS[10]*UV[3];
  JUV[3] = JVS[11]*UV[0]+JVS[12]*UV[1]+JVS[13]*UV[2]+JVS[14]*UV[3];
}

/* End of Jac_SP_Vec function                                       */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */


/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* JacTR_SP_Vec - sparse multiplication: sparse Jacobian transposed times vector */
/*   Arguments :                                                    */
/*      JVS       - sparse Jacobian of variables                    */
/*      UV        - User vector for variables                       */
/*      JTUV      - Jacobian transposed times user vector           */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

void JacTR_SP_Vec( 
  float JVS[],                           /* sparse Jacobian of variables */
  float UV[],                            /* User vector for variables */
  float JTUV[]                           /* Jacobian transposed times user vector */
)
{
  JTUV[0] = JVS[0]*UV[0]+JVS[3]*UV[1]+JVS[7]*UV[2]+JVS[11]*UV[3];
  JTUV[1] = JVS[1]*UV[0]+JVS[4]*UV[1]+JVS[8]*UV[2]+JVS[12]*UV[3];
  JTUV[2] = JVS[5]*UV[1]+JVS[9]*UV[2]+JVS[13]*UV[3];
  JTUV[3] = JVS[2]*UV[0]+JVS[10]*UV[2]+JVS[14]*UV[3];
}

/* End of JacTR_SP_Vec function                                     */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */


