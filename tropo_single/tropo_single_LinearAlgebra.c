/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* Linear Algebra Data and Routines File                            */
/*                                                                  */
/* Generated by KPP-2.2.3 symbolic chemistry Kinetics PreProcessor  */
/*       (http://www.cs.vt.edu/~asandu/Software/KPP)                */
/* KPP is distributed under GPL, the general public licence         */
/*       (http://www.gnu.org/copyleft/gpl.html)                     */
/* (C) 1995-1997, V. Damian & A. Sandu, CGRER, Univ. Iowa           */
/* (C) 1997-2005, A. Sandu, Michigan Tech, Virginia Tech            */
/*     With important contributions from:                           */
/*        M. Damian, Villanova University, USA                      */
/*        R. Sander, Max-Planck Institute for Chemistry, Mainz, Germany */
/*                                                                  */
/* File                 : tropo_single_LinearAlgebra.c              */
/* Time                 : Wed Mar  9 11:42:46 2022                  */
/* Working directory    : /home/kyriacos/CyprusInstitute/kpp/tropo_single */
/* Equation file        : tropo_single.kpp                          */
/* Output root filename : tropo_single                              */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>
#include <sys/time.h>
#include "tropo_single_Parameters.h"
#include "tropo_single_Global.h"
#include "tropo_single_Sparse.h"


/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* SPARSE_UTIL - SPARSE utility functions                           */
/*   Arguments :                                                    */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */


int KppDecomp( float *JVS )
{
float W[84];
float a;
int k, kk, j, jj;

  for( k = 0; k < 84; k++ ) {
    if( JVS[ LU_DIAG[k] ] == 0.0 ) return k+1;
    for( kk = LU_CROW[k]; kk < LU_CROW[k+1]; kk++ )
      W[ LU_ICOL[kk] ] = JVS[kk];
    for( kk = LU_CROW[k]; kk < LU_DIAG[k]; kk++ ) {
      j = LU_ICOL[kk];
      a = -W[j] / JVS[ LU_DIAG[j] ];
      W[j] = -a;
      for( jj = LU_DIAG[j]+1; jj < LU_CROW[j+1]; jj++ )
        W[ LU_ICOL[jj] ] += a*JVS[jj];
    }
    for( kk = LU_CROW[k]; kk < LU_CROW[k+1]; kk++ )
      JVS[kk] = W[ LU_ICOL[kk] ];
  }
  return 0;
}

/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Sparse LU factorization, complex
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
int KppDecompCmplxR( float JVSR[], float JVSI[] )
{
   float WR[NVAR], WI[NVAR];
   float ar, ai, den;
   int k, kk, j, jj;

   for( k = 0; k < NVAR; k++ ) {
	if( JVSR[ LU_DIAG[k] ] == 0.0 ) return k+1;
	if( JVSI[ LU_DIAG[k] ] == 0.0 ) return k+1;
	for( kk = LU_CROW[k]; kk < LU_CROW[k+1]; kk++ ) {
		WR[ LU_ICOL[kk] ] = JVSR[kk];
		WI[ LU_ICOL[kk] ] = JVSI[kk];
	}
	for( kk = LU_CROW[k]; kk < LU_DIAG[k]; kk++ ) {
	   j = LU_ICOL[kk];
	   den = JVSR[LU_DIAG[j]]*JVSR[LU_DIAG[j]] + JVSI[LU_DIAG[j]]*JVSI[LU_DIAG[j]];
	   ar = -(WR[j]*JVSR[LU_DIAG[j]] + WI[j]*JVSI[LU_DIAG[j]])/den;
	   ai = -(WI[j]*JVSR[LU_DIAG[j]] - WR[j]*JVSI[LU_DIAG[j]])/den;
	   WR[j] = -ar;
	   WI[j] = -ai;
	   for( jj = LU_DIAG[j]+1; jj < LU_CROW[j+1]; jj++ ) {
		   WR[ LU_ICOL[jj] ] = WR[ LU_ICOL[jj] ] + ar*JVSR[jj] - ai*JVSI[jj];
		   WI[ LU_ICOL[jj] ] = WI[ LU_ICOL[jj] ] + ar*JVSI[jj] + ai*JVSR[jj];
	   }
	}
	for( kk = LU_CROW[k]; kk < LU_CROW[k+1]; kk++ ) {
	   JVSR[kk] = WR[ LU_ICOL[kk] ];
	   JVSI[kk] = WI[ LU_ICOL[kk] ];
	}
   }
   return 0;
}

/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Complex sparse solve subroutine using indirect addressing
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
void KppSolveCmplxR(float JVSR[], float JVSI[], float XR[], float XI[])
{
   int i, j;
   float sumr, sumi, den;

   for ( i = 0; i < NVAR; i++ ) {
	for ( j = LU_CROW[i]; j < LU_DIAG[i]; j++ ) {
	   XR[i] = XR[i] - (JVSR[j]*XR[LU_ICOL[j]] - JVSI[j]*XI[LU_ICOL[j]]);
	   XI[i] = XI[i] - (JVSR[j]*XI[LU_ICOL[j]] + JVSI[j]*XR[LU_ICOL[j]]);
	}
   }
   
   for ( i = NVAR-1; i >= 0; i-- ) {
	sumr = XR[i];
	sumi = XI[i];
	for ( j = LU_DIAG[i]+1; j < LU_CROW[i+1]; j++) {
	   sumr = sumr - (JVSR[j]*XR[LU_ICOL[j]] - JVSI[j]*XI[LU_ICOL[j]]);
	   sumi = sumi - (JVSR[j]*XI[LU_ICOL[j]] + JVSI[j]*XR[LU_ICOL[j]]);
	}
	den = JVSR[LU_DIAG[i]]*JVSR[LU_DIAG[i]] + JVSI[LU_DIAG[i]]*JVSI[LU_DIAG[i]];
  	XR[i] = (sumr*JVSR[LU_DIAG[i]] + sumi*JVSI[LU_DIAG[i]])/den; 
  	XI[i] = (sumi*JVSR[LU_DIAG[i]] - sumr*JVSI[LU_DIAG[i]])/den;
   }
}
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	END FUNCTION KppSolveCmplxR
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
/* End of SPARSE_UTIL function                                      */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */


/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* KppSolve - sparse back substitution                              */
/*   Arguments :                                                    */
/*      JVS       - sparse Jacobian of variables                    */
/*      X         - Vector for variables                            */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

void KppSolve( 
  float JVS[],                           /* sparse Jacobian of variables */
  float X[]                              /* Vector for variables */
)
{
  X[35] = X[35]-JVS[117]*X[23];
  X[37] = X[37]-JVS[125]*X[27];
  X[38] = X[38]-JVS[131]*X[35];
  X[40] = X[40]-JVS[140]*X[34]-JVS[141]*X[39];
  X[43] = X[43]-JVS[164]*X[23];
  X[45] = X[45]-JVS[174]*X[19];
  X[46] = X[46]-JVS[180]*X[39];
  X[50] = X[50]-JVS[201]*X[18];
  X[53] = X[53]-JVS[219]*X[24]-JVS[220]*X[33]-JVS[221]*X[35]-JVS[222]
         *X[43];
  X[55] = X[55]-JVS[235]*X[21]-JVS[236]*X[44];
  X[56] = X[56]-JVS[244]*X[25]-JVS[245]*X[29]-JVS[246]*X[35]-JVS[247]
         *X[44];
  X[57] = X[57]-JVS[259]*X[42]-JVS[260]*X[48]-JVS[261]*X[49];
  X[60] = X[60]-JVS[283]*X[29];
  X[61] = X[61]-JVS[289]*X[45]-JVS[290]*X[60];
  X[62] = X[62]-JVS[296]*X[61];
  X[64] = X[64]-JVS[306]*X[28]-JVS[307]*X[39]-JVS[308]*X[59]-JVS[309]
         *X[60]-JVS[310]*X[62];
  X[65] = X[65]-JVS[320]*X[20];
  X[66] = X[66]-JVS[328]*X[59];
  X[68] = X[68]-JVS[345]*X[63];
  X[69] = X[69]-JVS[354]*X[63];
  X[70] = X[70]-JVS[363]*X[38]-JVS[364]*X[43]-JVS[365]*X[45]-JVS[366]
         *X[46]-JVS[367]*X[47]-JVS[368]*X[48]-JVS[369]*X[50]-JVS[370]
         *X[52]-JVS[371]*X[53]-JVS[372]*X[55]-JVS[373]*X[58]-JVS[374]
         *X[59]-JVS[375]*X[60]-JVS[376]*X[61]-JVS[377]*X[63]-JVS[378]
         *X[64]-JVS[379]*X[65]-JVS[380]*X[68]-JVS[381]*X[69];
  X[71] = X[71]-JVS[394]*X[31]-JVS[395]*X[33]-JVS[396]*X[41]-JVS[397]
         *X[43]-JVS[398]*X[49]-JVS[399]*X[53]-JVS[400]*X[57]-JVS[401]
         *X[58]-JVS[402]*X[61]-JVS[403]*X[62]-JVS[404]*X[65]-JVS[405]
         *X[67];
  X[72] = X[72]-JVS[417]*X[52]-JVS[418]*X[54]-JVS[419]*X[63]-JVS[420]
         *X[69];
  X[73] = X[73]-JVS[429]*X[10]-JVS[430]*X[11]-JVS[431]*X[12]-JVS[432]
         *X[13]-JVS[433]*X[14]-JVS[434]*X[39]-JVS[435]*X[59]-JVS[436]
         *X[63]-JVS[437]*X[72];
  X[74] = X[74]-JVS[446]*X[52]-JVS[447]*X[54]-JVS[448]*X[63]-JVS[449]
         *X[67]-JVS[450]*X[68]-JVS[451]*X[72]-JVS[452]*X[73];
  X[75] = X[75]-JVS[460]*X[20]-JVS[461]*X[21]-JVS[462]*X[24]-JVS[463]
         *X[25]-JVS[464]*X[30]-JVS[465]*X[31]-JVS[466]*X[35]-JVS[467]
         *X[36]-JVS[468]*X[37]-JVS[469]*X[38]-JVS[470]*X[42]-JVS[471]
         *X[43]-JVS[472]*X[45]-JVS[473]*X[46]-JVS[474]*X[47]-JVS[475]
         *X[48]-JVS[476]*X[49]-JVS[477]*X[50]-JVS[478]*X[51]-JVS[479]
         *X[52]-JVS[480]*X[53]-JVS[481]*X[54]-JVS[482]*X[55]-JVS[483]
         *X[56]-JVS[484]*X[58]-JVS[485]*X[59]-JVS[486]*X[60]-JVS[487]
         *X[61]-JVS[488]*X[62]-JVS[489]*X[63]-JVS[490]*X[64]-JVS[491]
         *X[65]-JVS[492]*X[66]-JVS[493]*X[67]-JVS[494]*X[68]-JVS[495]
         *X[69]-JVS[496]*X[70]-JVS[497]*X[71]-JVS[498]*X[72]-JVS[499]
         *X[73]-JVS[500]*X[74];
  X[76] = X[76]-JVS[510]*X[36]-JVS[511]*X[37]-JVS[512]*X[39]-JVS[513]
         *X[42]-JVS[514]*X[44]-JVS[515]*X[46]-JVS[516]*X[47]-JVS[517]
         *X[48]-JVS[518]*X[49]-JVS[519]*X[51]-JVS[520]*X[52]-JVS[521]
         *X[54]-JVS[522]*X[55]-JVS[523]*X[58]-JVS[524]*X[59]-JVS[525]
         *X[60]-JVS[526]*X[62]-JVS[527]*X[63]-JVS[528]*X[64]-JVS[529]
         *X[66]-JVS[530]*X[70]-JVS[531]*X[71]-JVS[532]*X[72]-JVS[533]
         *X[73]-JVS[534]*X[74]-JVS[535]*X[75];
  X[77] = X[77]-JVS[544]*X[17]-JVS[545]*X[66]-JVS[546]*X[67]-JVS[547]
         *X[68]-JVS[548]*X[69]-JVS[549]*X[72]-JVS[550]*X[73]-JVS[551]
         *X[74]-JVS[552]*X[75]-JVS[553]*X[76];
  X[78] = X[78]-JVS[561]*X[37]-JVS[562]*X[45]-JVS[563]*X[46]-JVS[564]
         *X[47]-JVS[565]*X[50]-JVS[566]*X[51]-JVS[567]*X[59]-JVS[568]
         *X[60]-JVS[569]*X[61]-JVS[570]*X[62]-JVS[571]*X[66]-JVS[572]
         *X[73]-JVS[573]*X[74]-JVS[574]*X[75]-JVS[575]*X[76]-JVS[576]
         *X[77];
  X[79] = X[79]-JVS[583]*X[39]-JVS[584]*X[59]-JVS[585]*X[63]-JVS[586]
         *X[72]-JVS[587]*X[73]-JVS[588]*X[74]-JVS[589]*X[75]-JVS[590]
         *X[76]-JVS[591]*X[77]-JVS[592]*X[78];
  X[80] = X[80]-JVS[598]*X[26]-JVS[599]*X[36]-JVS[600]*X[37]-JVS[601]
         *X[38]-JVS[602]*X[42]-JVS[603]*X[43]-JVS[604]*X[45]-JVS[605]
         *X[46]-JVS[606]*X[47]-JVS[607]*X[48]-JVS[608]*X[49]-JVS[609]
         *X[50]-JVS[610]*X[51]-JVS[611]*X[52]-JVS[612]*X[53]-JVS[613]
         *X[54]-JVS[614]*X[55]-JVS[615]*X[58]-JVS[616]*X[59]-JVS[617]
         *X[60]-JVS[618]*X[61]-JVS[619]*X[62]-JVS[620]*X[63]-JVS[621]
         *X[64]-JVS[622]*X[65]-JVS[623]*X[66]-JVS[624]*X[67]-JVS[625]
         *X[68]-JVS[626]*X[69]-JVS[627]*X[70]-JVS[628]*X[71]-JVS[629]
         *X[72]-JVS[630]*X[73]-JVS[631]*X[74]-JVS[632]*X[75]-JVS[633]
         *X[76]-JVS[634]*X[77]-JVS[635]*X[78]-JVS[636]*X[79];
  X[81] = X[81]-JVS[641]*X[22]-JVS[642]*X[23]-JVS[643]*X[30]-JVS[644]
         *X[32]-JVS[645]*X[33]-JVS[646]*X[34]-JVS[647]*X[35]-JVS[648]
         *X[36]-JVS[649]*X[38]-JVS[650]*X[39]-JVS[651]*X[40]-JVS[652]
         *X[41]-JVS[653]*X[42]-JVS[654]*X[43]-JVS[655]*X[44]-JVS[656]
         *X[45]-JVS[657]*X[46]-JVS[658]*X[47]-JVS[659]*X[48]-JVS[660]
         *X[49]-JVS[661]*X[50]-JVS[662]*X[51]-JVS[663]*X[52]-JVS[664]
         *X[53]-JVS[665]*X[54]-JVS[666]*X[55]-JVS[667]*X[57]-JVS[668]
         *X[58]-JVS[669]*X[59]-JVS[670]*X[60]-JVS[671]*X[61]-JVS[672]
         *X[62]-JVS[673]*X[63]-JVS[674]*X[64]-JVS[675]*X[65]-JVS[676]
         *X[67]-JVS[677]*X[68]-JVS[678]*X[69]-JVS[679]*X[70]-JVS[680]
         *X[71]-JVS[681]*X[72]-JVS[682]*X[73]-JVS[683]*X[74]-JVS[684]
         *X[75]-JVS[685]*X[76]-JVS[686]*X[77]-JVS[687]*X[78]-JVS[688]
         *X[79]-JVS[689]*X[80];
  X[82] = X[82]-JVS[693]*X[25]-JVS[694]*X[29]-JVS[695]*X[35]-JVS[696]
         *X[44]-JVS[697]*X[56]-JVS[698]*X[58]-JVS[699]*X[59]-JVS[700]
         *X[61]-JVS[701]*X[63]-JVS[702]*X[65]-JVS[703]*X[66]-JVS[704]
         *X[67]-JVS[705]*X[68]-JVS[706]*X[69]-JVS[707]*X[72]-JVS[708]
         *X[73]-JVS[709]*X[74]-JVS[710]*X[75]-JVS[711]*X[76]-JVS[712]
         *X[77]-JVS[713]*X[78]-JVS[714]*X[79]-JVS[715]*X[80]-JVS[716]
         *X[81];
  X[83] = X[83]-JVS[719]*X[15]-JVS[720]*X[16]-JVS[721]*X[17]-JVS[722]
         *X[18]-JVS[723]*X[19]-JVS[724]*X[22]-JVS[725]*X[23]-JVS[726]
         *X[26]-JVS[727]*X[27]-JVS[728]*X[28]-JVS[729]*X[29]-JVS[730]
         *X[30]-JVS[731]*X[31]-JVS[732]*X[32]-JVS[733]*X[33]-JVS[734]
         *X[34]-JVS[735]*X[35]-JVS[736]*X[36]-JVS[737]*X[39]-JVS[738]
         *X[40]-JVS[739]*X[41]-JVS[740]*X[43]-JVS[741]*X[44]-JVS[742]
         *X[53]-JVS[743]*X[56]-JVS[744]*X[57]-JVS[745]*X[58]-JVS[746]
         *X[59]-JVS[747]*X[60]-JVS[748]*X[61]-JVS[749]*X[62]-JVS[750]
         *X[63]-JVS[751]*X[65]-JVS[752]*X[67]-JVS[753]*X[69]-JVS[754]
         *X[70]-JVS[755]*X[71]-JVS[756]*X[72]-JVS[757]*X[73]-JVS[758]
         *X[74]-JVS[759]*X[75]-JVS[760]*X[76]-JVS[761]*X[77]-JVS[762]
         *X[78]-JVS[763]*X[79]-JVS[764]*X[80]-JVS[765]*X[81]-JVS[766]
         *X[82];
  X[83] = X[83]/JVS[767];
  X[82] = (X[82]-JVS[718]*X[83])/(JVS[717]);
  X[81] = (X[81]-JVS[691]*X[82]-JVS[692]*X[83])/(JVS[690]);
  X[80] = (X[80]-JVS[638]*X[81]-JVS[639]*X[82]-JVS[640]*X[83])
         /(JVS[637]);
  X[79] = (X[79]-JVS[594]*X[80]-JVS[595]*X[81]-JVS[596]*X[82]-JVS[597]
         *X[83])/(JVS[593]);
  X[78] = (X[78]-JVS[578]*X[79]-JVS[579]*X[80]-JVS[580]*X[81]-JVS[581]
         *X[82]-JVS[582]*X[83])/(JVS[577]);
  X[77] = (X[77]-JVS[555]*X[78]-JVS[556]*X[79]-JVS[557]*X[80]-JVS[558]
         *X[81]-JVS[559]*X[82]-JVS[560]*X[83])/(JVS[554]);
  X[76] = (X[76]-JVS[537]*X[77]-JVS[538]*X[78]-JVS[539]*X[79]-JVS[540]
         *X[80]-JVS[541]*X[81]-JVS[542]*X[82]-JVS[543]*X[83])
         /(JVS[536]);
  X[75] = (X[75]-JVS[502]*X[76]-JVS[503]*X[77]-JVS[504]*X[78]-JVS[505]
         *X[79]-JVS[506]*X[80]-JVS[507]*X[81]-JVS[508]*X[82]-JVS[509]
         *X[83])/(JVS[501]);
  X[74] = (X[74]-JVS[454]*X[75]-JVS[455]*X[77]-JVS[456]*X[80]-JVS[457]
         *X[81]-JVS[458]*X[82]-JVS[459]*X[83])/(JVS[453]);
  X[73] = (X[73]-JVS[439]*X[74]-JVS[440]*X[75]-JVS[441]*X[77]-JVS[442]
         *X[80]-JVS[443]*X[81]-JVS[444]*X[82]-JVS[445]*X[83])
         /(JVS[438]);
  X[72] = (X[72]-JVS[422]*X[73]-JVS[423]*X[75]-JVS[424]*X[77]-JVS[425]
         *X[80]-JVS[426]*X[81]-JVS[427]*X[82]-JVS[428]*X[83])
         /(JVS[421]);
  X[71] = (X[71]-JVS[407]*X[72]-JVS[408]*X[73]-JVS[409]*X[74]-JVS[410]
         *X[75]-JVS[411]*X[77]-JVS[412]*X[78]-JVS[413]*X[80]-JVS[414]
         *X[81]-JVS[415]*X[82]-JVS[416]*X[83])/(JVS[406]);
  X[70] = (X[70]-JVS[383]*X[71]-JVS[384]*X[72]-JVS[385]*X[73]-JVS[386]
         *X[74]-JVS[387]*X[75]-JVS[388]*X[77]-JVS[389]*X[78]-JVS[390]
         *X[80]-JVS[391]*X[81]-JVS[392]*X[82]-JVS[393]*X[83])
         /(JVS[382]);
  X[69] = (X[69]-JVS[356]*X[73]-JVS[357]*X[75]-JVS[358]*X[77]-JVS[359]
         *X[80]-JVS[360]*X[81]-JVS[361]*X[82]-JVS[362]*X[83])
         /(JVS[355]);
  X[68] = (X[68]-JVS[347]*X[73]-JVS[348]*X[75]-JVS[349]*X[77]-JVS[350]
         *X[80]-JVS[351]*X[81]-JVS[352]*X[82]-JVS[353]*X[83])
         /(JVS[346]);
  X[67] = (X[67]-JVS[339]*X[72]-JVS[340]*X[73]-JVS[341]*X[74]-JVS[342]
         *X[75]-JVS[343]*X[77]-JVS[344]*X[80])/(JVS[338]);
  X[66] = (X[66]-JVS[330]*X[73]-JVS[331]*X[75]-JVS[332]*X[76]-JVS[333]
         *X[77]-JVS[334]*X[78]-JVS[335]*X[80]-JVS[336]*X[82]-JVS[337]
         *X[83])/(JVS[329]);
  X[65] = (X[65]-JVS[322]*X[72]-JVS[323]*X[75]-JVS[324]*X[80]-JVS[325]
         *X[81]-JVS[326]*X[82]-JVS[327]*X[83])/(JVS[321]);
  X[64] = (X[64]-JVS[312]*X[70]-JVS[313]*X[71]-JVS[314]*X[73]-JVS[315]
         *X[78]-JVS[316]*X[80]-JVS[317]*X[81]-JVS[318]*X[82]-JVS[319]
         *X[83])/(JVS[311]);
  X[63] = (X[63]-JVS[303]*X[73]-JVS[304]*X[82]-JVS[305]*X[83])
         /(JVS[302]);
  X[62] = (X[62]-JVS[298]*X[80]-JVS[299]*X[81]-JVS[300]*X[82]-JVS[301]
         *X[83])/(JVS[297]);
  X[61] = (X[61]-JVS[292]*X[80]-JVS[293]*X[81]-JVS[294]*X[82]-JVS[295]
         *X[83])/(JVS[291]);
  X[60] = (X[60]-JVS[285]*X[80]-JVS[286]*X[81]-JVS[287]*X[82]-JVS[288]
         *X[83])/(JVS[284]);
  X[59] = (X[59]-JVS[280]*X[73]-JVS[281]*X[82]-JVS[282]*X[83])
         /(JVS[279]);
  X[58] = (X[58]-JVS[275]*X[74]-JVS[276]*X[80]-JVS[277]*X[81]-JVS[278]
         *X[83])/(JVS[274]);
  X[57] = (X[57]-JVS[263]*X[58]-JVS[264]*X[65]-JVS[265]*X[67]-JVS[266]
         *X[72]-JVS[267]*X[73]-JVS[268]*X[74]-JVS[269]*X[75]-JVS[270]
         *X[80]-JVS[271]*X[81]-JVS[272]*X[82]-JVS[273]*X[83])
         /(JVS[262]);
  X[56] = (X[56]-JVS[249]*X[58]-JVS[250]*X[61]-JVS[251]*X[72]-JVS[252]
         *X[75]-JVS[253]*X[76]-JVS[254]*X[78]-JVS[255]*X[80]-JVS[256]
         *X[81]-JVS[257]*X[82]-JVS[258]*X[83])/(JVS[248]);
  X[55] = (X[55]-JVS[238]*X[58]-JVS[239]*X[75]-JVS[240]*X[80]-JVS[241]
         *X[81]-JVS[242]*X[82]-JVS[243]*X[83])/(JVS[237]);
  X[54] = (X[54]-JVS[230]*X[63]-JVS[231]*X[75]-JVS[232]*X[80]-JVS[233]
         *X[81]-JVS[234]*X[82])/(JVS[229]);
  X[53] = (X[53]-JVS[224]*X[75]-JVS[225]*X[80]-JVS[226]*X[81]-JVS[227]
         *X[82]-JVS[228]*X[83])/(JVS[223]);
  X[52] = (X[52]-JVS[215]*X[63]-JVS[216]*X[80]-JVS[217]*X[81]-JVS[218]
         *X[83])/(JVS[214]);
  X[51] = (X[51]-JVS[209]*X[59]-JVS[210]*X[75]-JVS[211]*X[80]-JVS[212]
         *X[81]-JVS[213]*X[82])/(JVS[208]);
  X[50] = (X[50]-JVS[203]*X[60]-JVS[204]*X[61]-JVS[205]*X[80]-JVS[206]
         *X[81]-JVS[207]*X[83])/(JVS[202]);
  X[49] = (X[49]-JVS[197]*X[74]-JVS[198]*X[80]-JVS[199]*X[81]-JVS[200]
         *X[82])/(JVS[196]);
  X[48] = (X[48]-JVS[192]*X[72]-JVS[193]*X[80]-JVS[194]*X[81]-JVS[195]
         *X[83])/(JVS[191]);
  X[47] = (X[47]-JVS[187]*X[59]-JVS[188]*X[80]-JVS[189]*X[81]-JVS[190]
         *X[83])/(JVS[186]);
  X[46] = (X[46]-JVS[182]*X[73]-JVS[183]*X[80]-JVS[184]*X[81]-JVS[185]
         *X[83])/(JVS[181]);
  X[45] = (X[45]-JVS[176]*X[60]-JVS[177]*X[80]-JVS[178]*X[81]-JVS[179]
         *X[83])/(JVS[175]);
  X[44] = (X[44]-JVS[170]*X[58]-JVS[171]*X[80]-JVS[172]*X[82]-JVS[173]
         *X[83])/(JVS[169]);
  X[43] = (X[43]-JVS[166]*X[80]-JVS[167]*X[81]-JVS[168]*X[83])
         /(JVS[165]);
  X[42] = (X[42]-JVS[160]*X[72]-JVS[161]*X[80]-JVS[162]*X[81]-JVS[163]
         *X[82])/(JVS[159]);
  X[41] = (X[41]-JVS[153]*X[43]-JVS[154]*X[53]-JVS[155]*X[62]-JVS[156]
         *X[80]-JVS[157]*X[81]-JVS[158]*X[83])/(JVS[152]);
  X[40] = (X[40]-JVS[143]*X[41]-JVS[144]*X[43]-JVS[145]*X[53]-JVS[146]
         *X[73]-JVS[147]*X[76]-JVS[148]*X[78]-JVS[149]*X[80]-JVS[150]
         *X[82]-JVS[151]*X[83])/(JVS[142]);
  X[39] = (X[39]-JVS[138]*X[73]-JVS[139]*X[83])/(JVS[137]);
  X[38] = (X[38]-JVS[133]*X[80]-JVS[134]*X[81]-JVS[135]*X[82]-JVS[136]
         *X[83])/(JVS[132]);
  X[37] = (X[37]-JVS[127]*X[60]-JVS[128]*X[62]-JVS[129]*X[80]-JVS[130]
         *X[83])/(JVS[126]);
  X[36] = (X[36]-JVS[122]*X[76]-JVS[123]*X[80]-JVS[124]*X[81])
         /(JVS[121]);
  X[35] = (X[35]-JVS[119]*X[82]-JVS[120]*X[83])/(JVS[118]);
  X[34] = (X[34]-JVS[113]*X[43]-JVS[114]*X[53]-JVS[115]*X[80]-JVS[116]
         *X[83])/(JVS[112]);
  X[33] = (X[33]-JVS[109]*X[43]-JVS[110]*X[80]-JVS[111]*X[83])
         /(JVS[108]);
  X[32] = (X[32]-JVS[103]*X[36]-JVS[104]*X[79]-JVS[105]*X[80]-JVS[106]
         *X[81]-JVS[107]*X[83])/(JVS[102]);
  X[31] = (X[31]-JVS[99]*X[71]-JVS[100]*X[75]-JVS[101]*X[83])/(JVS[98]);
  X[30] = (X[30]-JVS[95]*X[75]-JVS[96]*X[81]-JVS[97]*X[83])/(JVS[94]);
  X[29] = (X[29]-JVS[92]*X[82]-JVS[93]*X[83])/(JVS[91]);
  X[28] = (X[28]-JVS[87]*X[39]-JVS[88]*X[73]-JVS[89]*X[78]-JVS[90]
         *X[83])/(JVS[86]);
  X[27] = (X[27]-JVS[82]*X[60]-JVS[83]*X[62]-JVS[84]*X[80]-JVS[85]
         *X[83])/(JVS[81]);
  X[26] = (X[26]-JVS[78]*X[75]-JVS[79]*X[80]-JVS[80]*X[83])/(JVS[77]);
  X[25] = (X[25]-JVS[75]*X[75]-JVS[76]*X[82])/(JVS[74]);
  X[24] = (X[24]-JVS[72]*X[53]-JVS[73]*X[75])/(JVS[71]);
  X[23] = (X[23]-JVS[70]*X[83])/(JVS[69]);
  X[22] = (X[22]-JVS[67]*X[81]-JVS[68]*X[83])/(JVS[66]);
  X[21] = (X[21]-JVS[64]*X[55]-JVS[65]*X[75])/(JVS[63]);
  X[20] = (X[20]-JVS[61]*X[65]-JVS[62]*X[75])/(JVS[60]);
  X[19] = (X[19]-JVS[59]*X[83])/(JVS[58]);
  X[18] = (X[18]-JVS[57]*X[83])/(JVS[56]);
  X[17] = (X[17]-JVS[55]*X[83])/(JVS[54]);
  X[16] = (X[16]-JVS[52]*X[67]-JVS[53]*X[83])/(JVS[51]);
  X[15] = (X[15]-JVS[49]*X[69]-JVS[50]*X[83])/(JVS[48]);
  X[14] = (X[14]-JVS[47]*X[73])/(JVS[46]);
  X[13] = (X[13]-JVS[45]*X[73])/(JVS[44]);
  X[12] = (X[12]-JVS[43]*X[73])/(JVS[42]);
  X[11] = (X[11]-JVS[41]*X[73])/(JVS[40]);
  X[10] = (X[10]-JVS[39]*X[73])/(JVS[38]);
  X[9] = (X[9]-JVS[36]*X[17]-JVS[37]*X[83])/(JVS[35]);
  X[8] = (X[8]-JVS[31]*X[66]-JVS[32]*X[76]-JVS[33]*X[78]-JVS[34]*X[79])
        /(JVS[30]);
  X[7] = (X[7]-JVS[28]*X[51]-JVS[29]*X[81])/(JVS[27]);
  X[6] = (X[6]-JVS[25]*X[51]-JVS[26]*X[75])/(JVS[24]);
  X[5] = (X[5]-JVS[21]*X[12]-JVS[22]*X[14]-JVS[23]*X[73])/(JVS[20]);
  X[4] = (X[4]-JVS[17]*X[11]-JVS[18]*X[13]-JVS[19]*X[73])/(JVS[16]);
  X[3] = (X[3]-JVS[14]*X[10]-JVS[15]*X[73])/(JVS[13]);
  X[2] = (X[2]-JVS[11]*X[45]-JVS[12]*X[80])/(JVS[10]);
  X[1] = (X[1]-JVS[9]*X[66])/(JVS[8]);
  X[0] = (X[0]-JVS[1]*X[66]-JVS[2]*X[67]-JVS[3]*X[68]-JVS[4]*X[69]
        -JVS[5]*X[77]-JVS[6]*X[79]-JVS[7]*X[83])/(JVS[0]);
}

/* End of KppSolve function                                         */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */


/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* KppSolveTR - sparse, transposed back substitution                */
/*   Arguments :                                                    */
/*      JVS       - sparse Jacobian of variables                    */
/*      X         - Vector for variables                            */
/*      XX        - Vector for output variables                     */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

void KppSolveTR( 
  float JVS[],                           /* sparse Jacobian of variables */
  float X[],                             /* Vector for variables */
  float XX[]                             /* Vector for output variables */
)
{
  XX[0] = X[0]/JVS[0];
  XX[1] = X[1]/JVS[8];
  XX[2] = X[2]/JVS[10];
  XX[3] = X[3]/JVS[13];
  XX[4] = X[4]/JVS[16];
  XX[5] = X[5]/JVS[20];
  XX[6] = X[6]/JVS[24];
  XX[7] = X[7]/JVS[27];
  XX[8] = X[8]/JVS[30];
  XX[9] = X[9]/JVS[35];
  XX[10] = (X[10]-JVS[14]*XX[3])/(JVS[38]);
  XX[11] = (X[11]-JVS[17]*XX[4])/(JVS[40]);
  XX[12] = (X[12]-JVS[21]*XX[5])/(JVS[42]);
  XX[13] = (X[13]-JVS[18]*XX[4])/(JVS[44]);
  XX[14] = (X[14]-JVS[22]*XX[5])/(JVS[46]);
  XX[15] = X[15]/JVS[48];
  XX[16] = X[16]/JVS[51];
  XX[17] = (X[17]-JVS[36]*XX[9])/(JVS[54]);
  XX[18] = X[18]/JVS[56];
  XX[19] = X[19]/JVS[58];
  XX[20] = X[20]/JVS[60];
  XX[21] = X[21]/JVS[63];
  XX[22] = X[22]/JVS[66];
  XX[23] = X[23]/JVS[69];
  XX[24] = X[24]/JVS[71];
  XX[25] = X[25]/JVS[74];
  XX[26] = X[26]/JVS[77];
  XX[27] = X[27]/JVS[81];
  XX[28] = X[28]/JVS[86];
  XX[29] = X[29]/JVS[91];
  XX[30] = X[30]/JVS[94];
  XX[31] = X[31]/JVS[98];
  XX[32] = X[32]/JVS[102];
  XX[33] = X[33]/JVS[108];
  XX[34] = X[34]/JVS[112];
  XX[35] = X[35]/JVS[118];
  XX[36] = (X[36]-JVS[103]*XX[32])/(JVS[121]);
  XX[37] = X[37]/JVS[126];
  XX[38] = X[38]/JVS[132];
  XX[39] = (X[39]-JVS[87]*XX[28])/(JVS[137]);
  XX[40] = X[40]/JVS[142];
  XX[41] = (X[41]-JVS[143]*XX[40])/(JVS[152]);
  XX[42] = X[42]/JVS[159];
  XX[43] = (X[43]-JVS[109]*XX[33]-JVS[113]*XX[34]-JVS[144]*XX[40]
          -JVS[153]*XX[41])/(JVS[165]);
  XX[44] = X[44]/JVS[169];
  XX[45] = (X[45]-JVS[11]*XX[2])/(JVS[175]);
  XX[46] = X[46]/JVS[181];
  XX[47] = X[47]/JVS[186];
  XX[48] = X[48]/JVS[191];
  XX[49] = X[49]/JVS[196];
  XX[50] = X[50]/JVS[202];
  XX[51] = (X[51]-JVS[25]*XX[6]-JVS[28]*XX[7])/(JVS[208]);
  XX[52] = X[52]/JVS[214];
  XX[53] = (X[53]-JVS[72]*XX[24]-JVS[114]*XX[34]-JVS[145]*XX[40]
          -JVS[154]*XX[41])/(JVS[223]);
  XX[54] = X[54]/JVS[229];
  XX[55] = (X[55]-JVS[64]*XX[21])/(JVS[237]);
  XX[56] = X[56]/JVS[248];
  XX[57] = X[57]/JVS[262];
  XX[58] = (X[58]-JVS[170]*XX[44]-JVS[238]*XX[55]-JVS[249]*XX[56]
          -JVS[263]*XX[57])/(JVS[274]);
  XX[59] = (X[59]-JVS[187]*XX[47]-JVS[209]*XX[51])/(JVS[279]);
  XX[60] = (X[60]-JVS[82]*XX[27]-JVS[127]*XX[37]-JVS[176]*XX[45]
          -JVS[203]*XX[50])/(JVS[284]);
  XX[61] = (X[61]-JVS[204]*XX[50]-JVS[250]*XX[56])/(JVS[291]);
  XX[62] = (X[62]-JVS[83]*XX[27]-JVS[128]*XX[37]-JVS[155]*XX[41])
          /(JVS[297]);
  XX[63] = (X[63]-JVS[215]*XX[52]-JVS[230]*XX[54])/(JVS[302]);
  XX[64] = X[64]/JVS[311];
  XX[65] = (X[65]-JVS[61]*XX[20]-JVS[264]*XX[57])/(JVS[321]);
  XX[66] = (X[66]-JVS[1]*XX[0]-JVS[9]*XX[1]-JVS[31]*XX[8])/(JVS[329]);
  XX[67] = (X[67]-JVS[2]*XX[0]-JVS[52]*XX[16]-JVS[265]*XX[57])
          /(JVS[338]);
  XX[68] = (X[68]-JVS[3]*XX[0])/(JVS[346]);
  XX[69] = (X[69]-JVS[4]*XX[0]-JVS[49]*XX[15])/(JVS[355]);
  XX[70] = (X[70]-JVS[312]*XX[64])/(JVS[382]);
  XX[71] = (X[71]-JVS[99]*XX[31]-JVS[313]*XX[64]-JVS[383]*XX[70])
          /(JVS[406]);
  XX[72] = (X[72]-JVS[160]*XX[42]-JVS[192]*XX[48]-JVS[251]*XX[56]
          -JVS[266]*XX[57]-JVS[322]*XX[65]-JVS[339]*XX[67]-JVS[384]
          *XX[70]-JVS[407]*XX[71])/(JVS[421]);
  XX[73] = (X[73]-JVS[15]*XX[3]-JVS[19]*XX[4]-JVS[23]*XX[5]-JVS[39]
          *XX[10]-JVS[41]*XX[11]-JVS[43]*XX[12]-JVS[45]*XX[13]-JVS[47]
          *XX[14]-JVS[88]*XX[28]-JVS[138]*XX[39]-JVS[146]*XX[40]
          -JVS[182]*XX[46]-JVS[267]*XX[57]-JVS[280]*XX[59]-JVS[303]
          *XX[63]-JVS[314]*XX[64]-JVS[330]*XX[66]-JVS[340]*XX[67]
          -JVS[347]*XX[68]-JVS[356]*XX[69]-JVS[385]*XX[70]-JVS[408]
          *XX[71]-JVS[422]*XX[72])/(JVS[438]);
  XX[74] = (X[74]-JVS[197]*XX[49]-JVS[268]*XX[57]-JVS[275]*XX[58]
          -JVS[341]*XX[67]-JVS[386]*XX[70]-JVS[409]*XX[71]-JVS[439]
          *XX[73])/(JVS[453]);
  XX[75] = (X[75]-JVS[26]*XX[6]-JVS[62]*XX[20]-JVS[65]*XX[21]-JVS[73]
          *XX[24]-JVS[75]*XX[25]-JVS[78]*XX[26]-JVS[95]*XX[30]-JVS[100]
          *XX[31]-JVS[210]*XX[51]-JVS[224]*XX[53]-JVS[231]*XX[54]
          -JVS[239]*XX[55]-JVS[252]*XX[56]-JVS[269]*XX[57]-JVS[323]
          *XX[65]-JVS[331]*XX[66]-JVS[342]*XX[67]-JVS[348]*XX[68]
          -JVS[357]*XX[69]-JVS[387]*XX[70]-JVS[410]*XX[71]-JVS[423]
          *XX[72]-JVS[440]*XX[73]-JVS[454]*XX[74])/(JVS[501]);
  XX[76] = (X[76]-JVS[32]*XX[8]-JVS[122]*XX[36]-JVS[147]*XX[40]
          -JVS[253]*XX[56]-JVS[332]*XX[66]-JVS[502]*XX[75])/(JVS[536]);
  XX[77] = (X[77]-JVS[5]*XX[0]-JVS[333]*XX[66]-JVS[343]*XX[67]-JVS[349]
          *XX[68]-JVS[358]*XX[69]-JVS[388]*XX[70]-JVS[411]*XX[71]
          -JVS[424]*XX[72]-JVS[441]*XX[73]-JVS[455]*XX[74]-JVS[503]
          *XX[75]-JVS[537]*XX[76])/(JVS[554]);
  XX[78] = (X[78]-JVS[33]*XX[8]-JVS[89]*XX[28]-JVS[148]*XX[40]-JVS[254]
          *XX[56]-JVS[315]*XX[64]-JVS[334]*XX[66]-JVS[389]*XX[70]
          -JVS[412]*XX[71]-JVS[504]*XX[75]-JVS[538]*XX[76]-JVS[555]
          *XX[77])/(JVS[577]);
  XX[79] = (X[79]-JVS[6]*XX[0]-JVS[34]*XX[8]-JVS[104]*XX[32]-JVS[505]
          *XX[75]-JVS[539]*XX[76]-JVS[556]*XX[77]-JVS[578]*XX[78])
          /(JVS[593]);
  XX[80] = (X[80]-JVS[12]*XX[2]-JVS[79]*XX[26]-JVS[84]*XX[27]-JVS[105]
          *XX[32]-JVS[110]*XX[33]-JVS[115]*XX[34]-JVS[123]*XX[36]
          -JVS[129]*XX[37]-JVS[133]*XX[38]-JVS[149]*XX[40]-JVS[156]
          *XX[41]-JVS[161]*XX[42]-JVS[166]*XX[43]-JVS[171]*XX[44]
          -JVS[177]*XX[45]-JVS[183]*XX[46]-JVS[188]*XX[47]-JVS[193]
          *XX[48]-JVS[198]*XX[49]-JVS[205]*XX[50]-JVS[211]*XX[51]
          -JVS[216]*XX[52]-JVS[225]*XX[53]-JVS[232]*XX[54]-JVS[240]
          *XX[55]-JVS[255]*XX[56]-JVS[270]*XX[57]-JVS[276]*XX[58]
          -JVS[285]*XX[60]-JVS[292]*XX[61]-JVS[298]*XX[62]-JVS[316]
          *XX[64]-JVS[324]*XX[65]-JVS[335]*XX[66]-JVS[344]*XX[67]
          -JVS[350]*XX[68]-JVS[359]*XX[69]-JVS[390]*XX[70]-JVS[413]
          *XX[71]-JVS[425]*XX[72]-JVS[442]*XX[73]-JVS[456]*XX[74]
          -JVS[506]*XX[75]-JVS[540]*XX[76]-JVS[557]*XX[77]-JVS[579]
          *XX[78]-JVS[594]*XX[79])/(JVS[637]);
  XX[81] = (X[81]-JVS[29]*XX[7]-JVS[67]*XX[22]-JVS[96]*XX[30]-JVS[106]
          *XX[32]-JVS[124]*XX[36]-JVS[134]*XX[38]-JVS[157]*XX[41]
          -JVS[162]*XX[42]-JVS[167]*XX[43]-JVS[178]*XX[45]-JVS[184]
          *XX[46]-JVS[189]*XX[47]-JVS[194]*XX[48]-JVS[199]*XX[49]
          -JVS[206]*XX[50]-JVS[212]*XX[51]-JVS[217]*XX[52]-JVS[226]
          *XX[53]-JVS[233]*XX[54]-JVS[241]*XX[55]-JVS[256]*XX[56]
          -JVS[271]*XX[57]-JVS[277]*XX[58]-JVS[286]*XX[60]-JVS[293]
          *XX[61]-JVS[299]*XX[62]-JVS[317]*XX[64]-JVS[325]*XX[65]
          -JVS[351]*XX[68]-JVS[360]*XX[69]-JVS[391]*XX[70]-JVS[414]
          *XX[71]-JVS[426]*XX[72]-JVS[443]*XX[73]-JVS[457]*XX[74]
          -JVS[507]*XX[75]-JVS[541]*XX[76]-JVS[558]*XX[77]-JVS[580]
          *XX[78]-JVS[595]*XX[79]-JVS[638]*XX[80])/(JVS[690]);
  XX[82] = (X[82]-JVS[76]*XX[25]-JVS[92]*XX[29]-JVS[119]*XX[35]
          -JVS[135]*XX[38]-JVS[150]*XX[40]-JVS[163]*XX[42]-JVS[172]
          *XX[44]-JVS[200]*XX[49]-JVS[213]*XX[51]-JVS[227]*XX[53]
          -JVS[234]*XX[54]-JVS[242]*XX[55]-JVS[257]*XX[56]-JVS[272]
          *XX[57]-JVS[281]*XX[59]-JVS[287]*XX[60]-JVS[294]*XX[61]
          -JVS[300]*XX[62]-JVS[304]*XX[63]-JVS[318]*XX[64]-JVS[326]
          *XX[65]-JVS[336]*XX[66]-JVS[352]*XX[68]-JVS[361]*XX[69]
          -JVS[392]*XX[70]-JVS[415]*XX[71]-JVS[427]*XX[72]-JVS[444]
          *XX[73]-JVS[458]*XX[74]-JVS[508]*XX[75]-JVS[542]*XX[76]
          -JVS[559]*XX[77]-JVS[581]*XX[78]-JVS[596]*XX[79]-JVS[639]
          *XX[80]-JVS[691]*XX[81])/(JVS[717]);
  XX[83] = (X[83]-JVS[7]*XX[0]-JVS[37]*XX[9]-JVS[50]*XX[15]-JVS[53]
          *XX[16]-JVS[55]*XX[17]-JVS[57]*XX[18]-JVS[59]*XX[19]-JVS[68]
          *XX[22]-JVS[70]*XX[23]-JVS[80]*XX[26]-JVS[85]*XX[27]-JVS[90]
          *XX[28]-JVS[93]*XX[29]-JVS[97]*XX[30]-JVS[101]*XX[31]
          -JVS[107]*XX[32]-JVS[111]*XX[33]-JVS[116]*XX[34]-JVS[120]
          *XX[35]-JVS[130]*XX[37]-JVS[136]*XX[38]-JVS[139]*XX[39]
          -JVS[151]*XX[40]-JVS[158]*XX[41]-JVS[168]*XX[43]-JVS[173]
          *XX[44]-JVS[179]*XX[45]-JVS[185]*XX[46]-JVS[190]*XX[47]
          -JVS[195]*XX[48]-JVS[207]*XX[50]-JVS[218]*XX[52]-JVS[228]
          *XX[53]-JVS[243]*XX[55]-JVS[258]*XX[56]-JVS[273]*XX[57]
          -JVS[278]*XX[58]-JVS[282]*XX[59]-JVS[288]*XX[60]-JVS[295]
          *XX[61]-JVS[301]*XX[62]-JVS[305]*XX[63]-JVS[319]*XX[64]
          -JVS[327]*XX[65]-JVS[337]*XX[66]-JVS[353]*XX[68]-JVS[362]
          *XX[69]-JVS[393]*XX[70]-JVS[416]*XX[71]-JVS[428]*XX[72]
          -JVS[445]*XX[73]-JVS[459]*XX[74]-JVS[509]*XX[75]-JVS[543]
          *XX[76]-JVS[560]*XX[77]-JVS[582]*XX[78]-JVS[597]*XX[79]
          -JVS[640]*XX[80]-JVS[692]*XX[81]-JVS[718]*XX[82])/(JVS[767]);
  XX[83] = XX[83];
  XX[82] = XX[82]-JVS[766]*XX[83];
  XX[81] = XX[81]-JVS[716]*XX[82]-JVS[765]*XX[83];
  XX[80] = XX[80]-JVS[689]*XX[81]-JVS[715]*XX[82]-JVS[764]*XX[83];
  XX[79] = XX[79]-JVS[636]*XX[80]-JVS[688]*XX[81]-JVS[714]*XX[82]
          -JVS[763]*XX[83];
  XX[78] = XX[78]-JVS[592]*XX[79]-JVS[635]*XX[80]-JVS[687]*XX[81]
          -JVS[713]*XX[82]-JVS[762]*XX[83];
  XX[77] = XX[77]-JVS[576]*XX[78]-JVS[591]*XX[79]-JVS[634]*XX[80]
          -JVS[686]*XX[81]-JVS[712]*XX[82]-JVS[761]*XX[83];
  XX[76] = XX[76]-JVS[553]*XX[77]-JVS[575]*XX[78]-JVS[590]*XX[79]
          -JVS[633]*XX[80]-JVS[685]*XX[81]-JVS[711]*XX[82]-JVS[760]
          *XX[83];
  XX[75] = XX[75]-JVS[535]*XX[76]-JVS[552]*XX[77]-JVS[574]*XX[78]
          -JVS[589]*XX[79]-JVS[632]*XX[80]-JVS[684]*XX[81]-JVS[710]
          *XX[82]-JVS[759]*XX[83];
  XX[74] = XX[74]-JVS[500]*XX[75]-JVS[534]*XX[76]-JVS[551]*XX[77]
          -JVS[573]*XX[78]-JVS[588]*XX[79]-JVS[631]*XX[80]-JVS[683]
          *XX[81]-JVS[709]*XX[82]-JVS[758]*XX[83];
  XX[73] = XX[73]-JVS[452]*XX[74]-JVS[499]*XX[75]-JVS[533]*XX[76]
          -JVS[550]*XX[77]-JVS[572]*XX[78]-JVS[587]*XX[79]-JVS[630]
          *XX[80]-JVS[682]*XX[81]-JVS[708]*XX[82]-JVS[757]*XX[83];
  XX[72] = XX[72]-JVS[437]*XX[73]-JVS[451]*XX[74]-JVS[498]*XX[75]
          -JVS[532]*XX[76]-JVS[549]*XX[77]-JVS[586]*XX[79]-JVS[629]
          *XX[80]-JVS[681]*XX[81]-JVS[707]*XX[82]-JVS[756]*XX[83];
  XX[71] = XX[71]-JVS[497]*XX[75]-JVS[531]*XX[76]-JVS[628]*XX[80]
          -JVS[680]*XX[81]-JVS[755]*XX[83];
  XX[70] = XX[70]-JVS[496]*XX[75]-JVS[530]*XX[76]-JVS[627]*XX[80]
          -JVS[679]*XX[81]-JVS[754]*XX[83];
  XX[69] = XX[69]-JVS[381]*XX[70]-JVS[420]*XX[72]-JVS[495]*XX[75]
          -JVS[548]*XX[77]-JVS[626]*XX[80]-JVS[678]*XX[81]-JVS[706]
          *XX[82]-JVS[753]*XX[83];
  XX[68] = XX[68]-JVS[380]*XX[70]-JVS[450]*XX[74]-JVS[494]*XX[75]
          -JVS[547]*XX[77]-JVS[625]*XX[80]-JVS[677]*XX[81]-JVS[705]
          *XX[82];
  XX[67] = XX[67]-JVS[405]*XX[71]-JVS[449]*XX[74]-JVS[493]*XX[75]
          -JVS[546]*XX[77]-JVS[624]*XX[80]-JVS[676]*XX[81]-JVS[704]
          *XX[82]-JVS[752]*XX[83];
  XX[66] = XX[66]-JVS[492]*XX[75]-JVS[529]*XX[76]-JVS[545]*XX[77]
          -JVS[571]*XX[78]-JVS[623]*XX[80]-JVS[703]*XX[82];
  XX[65] = XX[65]-JVS[379]*XX[70]-JVS[404]*XX[71]-JVS[491]*XX[75]
          -JVS[622]*XX[80]-JVS[675]*XX[81]-JVS[702]*XX[82]-JVS[751]
          *XX[83];
  XX[64] = XX[64]-JVS[378]*XX[70]-JVS[490]*XX[75]-JVS[528]*XX[76]
          -JVS[621]*XX[80]-JVS[674]*XX[81];
  XX[63] = XX[63]-JVS[345]*XX[68]-JVS[354]*XX[69]-JVS[377]*XX[70]
          -JVS[419]*XX[72]-JVS[436]*XX[73]-JVS[448]*XX[74]-JVS[489]
          *XX[75]-JVS[527]*XX[76]-JVS[585]*XX[79]-JVS[620]*XX[80]
          -JVS[673]*XX[81]-JVS[701]*XX[82]-JVS[750]*XX[83];
  XX[62] = XX[62]-JVS[310]*XX[64]-JVS[403]*XX[71]-JVS[488]*XX[75]
          -JVS[526]*XX[76]-JVS[570]*XX[78]-JVS[619]*XX[80]-JVS[672]
          *XX[81]-JVS[749]*XX[83];
  XX[61] = XX[61]-JVS[296]*XX[62]-JVS[376]*XX[70]-JVS[402]*XX[71]
          -JVS[487]*XX[75]-JVS[569]*XX[78]-JVS[618]*XX[80]-JVS[671]
          *XX[81]-JVS[700]*XX[82]-JVS[748]*XX[83];
  XX[60] = XX[60]-JVS[290]*XX[61]-JVS[309]*XX[64]-JVS[375]*XX[70]
          -JVS[486]*XX[75]-JVS[525]*XX[76]-JVS[568]*XX[78]-JVS[617]
          *XX[80]-JVS[670]*XX[81]-JVS[747]*XX[83];
  XX[59] = XX[59]-JVS[308]*XX[64]-JVS[328]*XX[66]-JVS[374]*XX[70]
          -JVS[435]*XX[73]-JVS[485]*XX[75]-JVS[524]*XX[76]-JVS[567]
          *XX[78]-JVS[584]*XX[79]-JVS[616]*XX[80]-JVS[669]*XX[81]
          -JVS[699]*XX[82]-JVS[746]*XX[83];
  XX[58] = XX[58]-JVS[373]*XX[70]-JVS[401]*XX[71]-JVS[484]*XX[75]
          -JVS[523]*XX[76]-JVS[615]*XX[80]-JVS[668]*XX[81]-JVS[698]
          *XX[82]-JVS[745]*XX[83];
  XX[57] = XX[57]-JVS[400]*XX[71]-JVS[667]*XX[81]-JVS[744]*XX[83];
  XX[56] = XX[56]-JVS[483]*XX[75]-JVS[697]*XX[82]-JVS[743]*XX[83];
  XX[55] = XX[55]-JVS[372]*XX[70]-JVS[482]*XX[75]-JVS[522]*XX[76]
          -JVS[614]*XX[80]-JVS[666]*XX[81];
  XX[54] = XX[54]-JVS[418]*XX[72]-JVS[447]*XX[74]-JVS[481]*XX[75]
          -JVS[521]*XX[76]-JVS[613]*XX[80]-JVS[665]*XX[81];
  XX[53] = XX[53]-JVS[371]*XX[70]-JVS[399]*XX[71]-JVS[480]*XX[75]
          -JVS[612]*XX[80]-JVS[664]*XX[81]-JVS[742]*XX[83];
  XX[52] = XX[52]-JVS[370]*XX[70]-JVS[417]*XX[72]-JVS[446]*XX[74]
          -JVS[479]*XX[75]-JVS[520]*XX[76]-JVS[611]*XX[80]-JVS[663]
          *XX[81];
  XX[51] = XX[51]-JVS[478]*XX[75]-JVS[519]*XX[76]-JVS[566]*XX[78]
          -JVS[610]*XX[80]-JVS[662]*XX[81];
  XX[50] = XX[50]-JVS[369]*XX[70]-JVS[477]*XX[75]-JVS[565]*XX[78]
          -JVS[609]*XX[80]-JVS[661]*XX[81];
  XX[49] = XX[49]-JVS[261]*XX[57]-JVS[398]*XX[71]-JVS[476]*XX[75]
          -JVS[518]*XX[76]-JVS[608]*XX[80]-JVS[660]*XX[81];
  XX[48] = XX[48]-JVS[260]*XX[57]-JVS[368]*XX[70]-JVS[475]*XX[75]
          -JVS[517]*XX[76]-JVS[607]*XX[80]-JVS[659]*XX[81];
  XX[47] = XX[47]-JVS[367]*XX[70]-JVS[474]*XX[75]-JVS[516]*XX[76]
          -JVS[564]*XX[78]-JVS[606]*XX[80]-JVS[658]*XX[81];
  XX[46] = XX[46]-JVS[366]*XX[70]-JVS[473]*XX[75]-JVS[515]*XX[76]
          -JVS[563]*XX[78]-JVS[605]*XX[80]-JVS[657]*XX[81];
  XX[45] = XX[45]-JVS[289]*XX[61]-JVS[365]*XX[70]-JVS[472]*XX[75]
          -JVS[562]*XX[78]-JVS[604]*XX[80]-JVS[656]*XX[81];
  XX[44] = XX[44]-JVS[236]*XX[55]-JVS[247]*XX[56]-JVS[514]*XX[76]
          -JVS[655]*XX[81]-JVS[696]*XX[82]-JVS[741]*XX[83];
  XX[43] = XX[43]-JVS[222]*XX[53]-JVS[364]*XX[70]-JVS[397]*XX[71]
          -JVS[471]*XX[75]-JVS[603]*XX[80]-JVS[654]*XX[81]-JVS[740]
          *XX[83];
  XX[42] = XX[42]-JVS[259]*XX[57]-JVS[470]*XX[75]-JVS[513]*XX[76]
          -JVS[602]*XX[80]-JVS[653]*XX[81];
  XX[41] = XX[41]-JVS[396]*XX[71]-JVS[652]*XX[81]-JVS[739]*XX[83];
  XX[40] = XX[40]-JVS[651]*XX[81]-JVS[738]*XX[83];
  XX[39] = XX[39]-JVS[141]*XX[40]-JVS[180]*XX[46]-JVS[307]*XX[64]
          -JVS[434]*XX[73]-JVS[512]*XX[76]-JVS[583]*XX[79]-JVS[650]
          *XX[81]-JVS[737]*XX[83];
  XX[38] = XX[38]-JVS[363]*XX[70]-JVS[469]*XX[75]-JVS[601]*XX[80]
          -JVS[649]*XX[81];
  XX[37] = XX[37]-JVS[468]*XX[75]-JVS[511]*XX[76]-JVS[561]*XX[78]
          -JVS[600]*XX[80];
  XX[36] = XX[36]-JVS[467]*XX[75]-JVS[510]*XX[76]-JVS[599]*XX[80]
          -JVS[648]*XX[81]-JVS[736]*XX[83];
  XX[35] = XX[35]-JVS[131]*XX[38]-JVS[221]*XX[53]-JVS[246]*XX[56]
          -JVS[466]*XX[75]-JVS[647]*XX[81]-JVS[695]*XX[82]-JVS[735]
          *XX[83];
  XX[34] = XX[34]-JVS[140]*XX[40]-JVS[646]*XX[81]-JVS[734]*XX[83];
  XX[33] = XX[33]-JVS[220]*XX[53]-JVS[395]*XX[71]-JVS[645]*XX[81]
          -JVS[733]*XX[83];
  XX[32] = XX[32]-JVS[644]*XX[81]-JVS[732]*XX[83];
  XX[31] = XX[31]-JVS[394]*XX[71]-JVS[465]*XX[75]-JVS[731]*XX[83];
  XX[30] = XX[30]-JVS[464]*XX[75]-JVS[643]*XX[81]-JVS[730]*XX[83];
  XX[29] = XX[29]-JVS[245]*XX[56]-JVS[283]*XX[60]-JVS[694]*XX[82]
          -JVS[729]*XX[83];
  XX[28] = XX[28]-JVS[306]*XX[64]-JVS[728]*XX[83];
  XX[27] = XX[27]-JVS[125]*XX[37]-JVS[727]*XX[83];
  XX[26] = XX[26]-JVS[598]*XX[80]-JVS[726]*XX[83];
  XX[25] = XX[25]-JVS[244]*XX[56]-JVS[463]*XX[75]-JVS[693]*XX[82];
  XX[24] = XX[24]-JVS[219]*XX[53]-JVS[462]*XX[75];
  XX[23] = XX[23]-JVS[117]*XX[35]-JVS[164]*XX[43]-JVS[642]*XX[81]
          -JVS[725]*XX[83];
  XX[22] = XX[22]-JVS[641]*XX[81]-JVS[724]*XX[83];
  XX[21] = XX[21]-JVS[235]*XX[55]-JVS[461]*XX[75];
  XX[20] = XX[20]-JVS[320]*XX[65]-JVS[460]*XX[75];
  XX[19] = XX[19]-JVS[174]*XX[45]-JVS[723]*XX[83];
  XX[18] = XX[18]-JVS[201]*XX[50]-JVS[722]*XX[83];
  XX[17] = XX[17]-JVS[544]*XX[77]-JVS[721]*XX[83];
  XX[16] = XX[16]-JVS[720]*XX[83];
  XX[15] = XX[15]-JVS[719]*XX[83];
  XX[14] = XX[14]-JVS[433]*XX[73];
  XX[13] = XX[13]-JVS[432]*XX[73];
  XX[12] = XX[12]-JVS[431]*XX[73];
  XX[11] = XX[11]-JVS[430]*XX[73];
  XX[10] = XX[10]-JVS[429]*XX[73];
  XX[9] = XX[9];
  XX[8] = XX[8];
  XX[7] = XX[7];
  XX[6] = XX[6];
  XX[5] = XX[5];
  XX[4] = XX[4];
  XX[3] = XX[3];
  XX[2] = XX[2];
  XX[1] = XX[1];
  XX[0] = XX[0];
}

/* End of KppSolveTR function                                       */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */


/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*                                                                  */
/* BLAS_UTIL - BLAS-LIKE utility functions                          */
/*   Arguments :                                                    */
/*                                                                  */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

/*--------------------------------------------------------------
 
  BLAS/LAPACK-like subroutines used by the integration algorithms
  It is recommended to replace them by calls to the optimized
       BLAS/LAPACK library for your machine
 
   (C) Adrian Sandu, Aug. 2004
 
--------------------------------------------------------------*/

#define ZERO  (float)0.0
#define ONE   (float)1.0
#define HALF  (float)0.5
#define TWO   (float)2.0
#define MOD(A,B) (int)((A)%(B))

/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
void WCOPY(int N, float X[], int incX, float Y[], int incY)
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    copies a vector, x, to a vector, y:  y <- x
    only for incX=incY=1
    after BLAS
    replace this by the function from the optimized BLAS implementation:
        CALL  SCOPY(N,X,1,Y,1)   or   CALL  DCOPY(N,X,1,Y,1)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
{
      int i, M;
      if (N <= 0) return;

      M = MOD(N,8);
      if( M != 0 ) {
        for ( i = 0; i < M; i++ )
          Y[i] = X[i];
        if( N < 8 ) return;
      } /* end if */	
      for ( i = M; i<N; i+=8 ) {
        Y[i] = X[i];
        Y[i + 1] = X[i + 1];
        Y[i + 2] = X[i + 2];
        Y[i + 3] = X[i + 3];
        Y[i + 4] = X[i + 4];
        Y[i + 5] = X[i + 5];
        Y[i + 6] = X[i + 6];
        Y[i + 7] = X[i + 7];
      } /* end for */

} /* end function WCOPY */


/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
void WAXPY(int N, float Alpha, 
         float X[], int incX, 
	 float Y[], int incY )
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    constant times a vector plus a vector: y <- y + Alpha*x
    only for incX=incY=1
    after BLAS
    replace this by the function from the optimized BLAS implementation:
        CALL SAXPY(N,Alpha,X,1,Y,1) or  CALL DAXPY(N,Alpha,X,1,Y,1)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
{
      int i, M;

      if (Alpha == ZERO) return;
      if (N  <=  0) return;

      M = MOD(N,4);
      if( M != 0 ) {
        for ( i = 0; i < M; i++ )
          Y[i] = Y[i] + Alpha*X[i];
        if ( N < 4 ) return;
      } /* end if */
      
      for ( i = M; i < N; i += 4 ) {
        Y[i] = Y[i] + Alpha*X[i];
        Y[i + 1] = Y[i + 1] + Alpha*X[i + 1];
        Y[i + 2] = Y[i + 2] + Alpha*X[i + 2];
        Y[i + 3] = Y[i + 3] + Alpha*X[i + 3];
      } /* end for */

} /* end function  WAXPY */



/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
void WSCAL(int N, float Alpha, float X[], int incX)
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    constant times a vector: x(1:N) <- Alpha*x(1:N) 
    only for incX=incY=1
    after BLAS
    replace this by the function from the optimized BLAS implementation:
        CALL SSCAL(N,Alpha,X,1) or  CALL DSCAL(N,Alpha,X,1)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
{
      int i, M;
      
      if (Alpha == ONE) return;
      if (N  <=  0) return;

      M = MOD(N,5);
      if( M  !=  0 ) {
        if (Alpha == (-ONE))
          for ( i = 0; i < M; i++ )  X[i] = -X[i];
        else {
	  if (Alpha == ZERO)
            for ( i = 0; i < M; i++ ) X[i] = ZERO;
          else
            for ( i = 0; i < M; i++ ) X[i] = Alpha*X[i];
        } /* end else */
        if( N < 5 ) return;
      } /* end if */
      
      if (Alpha == (-ONE))
        for ( i = M; i<N; i+=5 ) {
          X[i]     = -X[i];
          X[i + 1] = -X[i + 1];
          X[i + 2] = -X[i + 2];
          X[i + 3] = -X[i + 3];
          X[i + 4] = -X[i + 4];
        } /* end for */
      else {
        if (Alpha == ZERO)
          for ( i = M; i < N; i += 5 ) {
            X[i]     = ZERO;
            X[i + 1] = ZERO;
            X[i + 2] = ZERO;
            X[i + 3] = ZERO;
            X[i + 4] = ZERO;
          } /* end for */
        else
          for ( i = M; i < N; i += 5 ) {
            X[i]     = Alpha*X[i];
            X[i + 1] = Alpha*X[i + 1];
            X[i + 2] = Alpha*X[i + 2];
            X[i + 3] = Alpha*X[i + 3];
            X[i + 4] = Alpha*X[i + 4];
           } /* end for */
      }  /* else  */
      
} /* end function WSCAL */
   
     
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
float WLAMCH_ADD( float  A, float  B )
{
      return (A + B);
} /* end function  WLAMCH_ADD */

/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
float WLAMCH( char C )
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    returns epsilon machine
    after LAPACK
    replace this by the function from the optimized LAPACK implementation:
         CALL SLAMCH('E') or CALL DLAMCH('E')
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
{
      int i;
      float Suma;
      static float Eps;
      static char First = 1;
      
      if (First) {
        First = 0;
        Eps = pow(HALF,16);
        for ( i = 17; i <= 80; i++ ) {
          Eps = Eps*HALF;
	  Suma = WLAMCH_ADD(ONE,Eps);
	  if (Suma <= ONE) break;
        } /* end for */
        if (i==80) {
	   printf("\nERROR IN WLAMCH. Very small EPS = %g\n",Eps);
           return (double)2.2e-16;
	}
        Eps *= TWO; i--;      
      } /* end if First */

      return Eps;

} /* end function WLAMCH */


/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 	copies zeros into the vector y:  y <- 0 after BLAS
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
void Set2Zero(int N, float Y[])
{
   int i,M;
	
   if (N <= 0) return;

   M = MOD(N,8);
   if  (M != 0)
   {
	for (i = 0; i < M; i++)
	{
	   Y[i] = ZERO;
	}
	if (N < 8) 
	   return;
   } /* end if */
   for (i = M; i < N; i += 8)
   {
   	Y[i] = ZERO;
	Y[i + 1] = ZERO;
        Y[i + 2] = ZERO;
	Y[i + 3] = ZERO;
	Y[i + 4] = ZERO;
	Y[i + 5] = ZERO;
	Y[i + 6] = ZERO;
	Y[i + 7] = ZERO;
   } /* end for */
} /* end function Set2Zero */


/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	adds two vectors: z <- x + y     BLAS - like
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
void WADD(int N, float X[], float Y[], float Z[])
{
	int i, M;

	if ( N <= 0 ) return;
	
	M = MOD(N,5);
	if ( M != 0 )
	{
	   for(i = 0; i < M; i++)
	   {
		Z[i] = X[i] + Y[i];
	   }
	   if ( N < 5 ) return;
	} /* end if */
	for (i = M; i < N; i += 5)
	{
	   Z[i] = X[i] + Y[i];
	   Z[i + 1] = X[i + 1] + Y[i + 1];
	   Z[i + 2] = X[i + 2] + Y[i + 2];
	   Z[i + 3] = X[i + 3] + Y[i + 3];
	   Z[i + 4] = X[i + 4] + Y[i + 4];
	} /* end for */
} /* end function WADD */
/* End of BLAS_UTIL function                                        */
/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */


